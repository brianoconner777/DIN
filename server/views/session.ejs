<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<title>DIN Form</title>
		<link rel="stylesheet" type="text/css" href="css/default.css" />
		<link rel="stylesheet" type="text/css" href="css/component.css" />
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css">
		<script src="js/modernizr.custom.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">


	</head>
	<body>
		<div class="container">
			<header class="clearfix">
				
				<h1>DIN Form</h1>
				
			</header>	
			<div class="main">
				<form class="cbp-mc-form">
					<div class="cbp-mc-column">
						<label for="first_name">Session Name</label>
	  					<input type="text" id="session_name" name="first_name" placeholder="Jonathan">
	  					<label for="first_name">Session Current Rate</label>
	  					<input type="text" id="session_currentrate" name="first_name" placeholder="Jonathan">
	  					<label for="first_name">Session Description</label>
	  					<input type="text" id="session_description" name="first_name" placeholder="Jonathan">
	  					
	  				</div>
	  				<div class="cbp-mc-column">
	  					<label for="phone">Session Category</label>
	  					<input type="text" id="session_category" name="phone" placeholder="+351 999 999">
	  					<label for="phone">Session Image</label>
	  					<input type="text" id="session_image" name="phone" placeholder="+351 999 999">
						<label for="phone">Session Minimum Person</label>
	  					<input type="text" id="session_minperson" name="phone" placeholder="+351 999 999">
						
	  					
	  				</div>
	  				<div class="cbp-mc-column">
						<label for="drink">Session Base Rate</label>
	  					<input type="text" id="session_baserate" name="drink" placeholder="3131">
	  					<label for="drink">Session Duration</label>
	  					<input type="text" id="session_duration" name="drink" placeholder="3131">
	  					
	  					<label for="weapon">id(unique)</label>
	  					<input type="weapon" id="id" name="weapon" placeholder="Lightsaber">
	  					
	  				</div>

	  				 <a id="demo01" href="#animatedModal">Enter Slot Information</a>
	  				  <div id="animatedModal">
					        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID  class="close-animatedModal" -->
					        <div class="close-animatedModal"> 
					            Close
					        </div>

					        <div class="slot_feedback" style="position:fixed; top:0; right:0; max-width:150px;"></div>
					            
					        <div class="modal-content">
					                 <label for="phone">Slot Name</label>
	  								 <input type="text" id="slot_name" name="phone" placeholder="+351 999 999">
					        		 <label for="phone">Slot Duration</label>
	  								 <input type="text" id="slot_duration" name="phone" placeholder="+351 999 999">
	  								 <label for="phone">Slot Start time</label>
	  								 <input type="text" id="timepicker1" name="phone" placeholder="+351 999 999">
	  								 <label for="phone">Slot End Time</label>
	  								 <input type="text" id="timepicker2" name="phone" placeholder="+351 999 999">
	  								 <label for="phone">Slot Rate</label>
	  								 <input type="text" id="slot_rate" name="phone" placeholder="+351 999 999">

	  								 <!-- <button class="submitslot">Submit Slot</button> -->
	  								 <input type="button" class="submitslot" value="Submit Slot"/>
					        </div>
					  </div>
	  				<div class="cbp-mc-submit-wrap"><input class="cbp-mc-submit" value="Upload" /></div>
				</form>
			</div>
		</div>
	</body>
	<script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>

<script type="text/javascript">
	
	
	
	$(document).ready(function(){

	function makeid()
	{
	    var text = "";
	    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

	    for( var i=0; i < 16; i++ )
	        text += possible.charAt(Math.floor(Math.random() * possible.length));

	    return text;
	}

	$('#timepicker1').timepicker({
    timeFormat: 'h:mm p',
    interval: 30,
    minTime: '12:00am ',
    maxTime: '11:59pm',
    startTime: '12:00am',
    dynamic: false,
    dropdown: true,
    scrollbar: true
});	
	$('#timepicker2').timepicker({
    timeFormat: 'h:mm p',
    interval: 30,
    minTime: '12:00am ',
    maxTime: '11:59pm',
    startTime: '12:00am',
    dynamic: false,
    dropdown: true,
    scrollbar: true
});

	$("#demo01").animatedModal();
	var session_slots = [];

	$('.submitslot').click(function(){
			var slot_id = makeid();
			var slot_name = $('#slot_name').val();
			var slot_duration = $('#slot_duration').val();
			var slot_starttime = $('#timepicker1').val();
			var slot_endtime = $('#timepicker2').val();
			var slot_rate = $('#slot_rate').val();
			var slotjson = {
				"slot_id" : slot_id,
				"slot_name":slot_name,
				"slot_duration":slot_duration,
				"slot_start_time":slot_starttime,
				"slot_end_time":slot_endtime,
				"slot_rate":slot_rate
			};
			
			session_slots.push(slotjson);
			slot_added = '<div class="slot_hide" style="position:relative; background-color:grey; cursor:pointer; margin:10px; padding:20px; color:white; ">Slot Added</div>';
			$('.slot_feedback').append(slot_added);
			$('div.slot_hide').on("click",function(){
				$(this).fadeOut(500);
			});
			
	}	
);
	$('.cbp-mc-submit').click(function(){
    var id = $("#id").val();
    var session_name = $('#session_name').val();
    var session_currentrate = $('#session_currentrate').val();
    var session_description = $('#session_description').val();
    var session_image = $('#session_image').val();
    var session_minperson = $('#session_minperson').val();
    var session_baserate = $('#session_baserate').val();
    var session_duration = $('#session_duration').val();
    
    var json = {
    	"session_id": makeid(),
    	"session_name":session_name,
    	"session_currentrate":session_currentrate,
    	"session_description":session_description,
    	"session_image":session_image,
    	"session_minperson":session_minperson,
    	"session_baserate":session_baserate,
    	"session_duration":session_duration,
    	"id":id,
    	"session_slots":session_slots,
    };

    $.ajax({
    	type:"GET",
    	url:"http://128.199.190.92/api/dingyms/"+id,
    	success: function(data){
    		if(!data.daily_sessions) {
    			data.daily_sessions = [];	
    		}
    		
    		data.daily_sessions.push(json);
    		var mainjson = data;
    		$.ajax({
		    	type:"PUT",
		    	url:"http://128.199.190.92/api/dingyms/"+id,
		    	data:mainjson,
		    	success: function(data){
		    		console.log(data);
		    		session_slots = [];
		    	}
		    });
    	}
    });
});
});

</script>

<script type="text/javascript" src= "./js/animatedModal.min.js"></script>

</html>


